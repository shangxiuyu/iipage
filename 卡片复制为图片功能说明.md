# 卡片复制为图片功能说明

## 功能概述

在白板应用中新增了"复制为图片"功能，允许用户将卡片内容转换为图片并复制到剪贴板，方便分享到其他应用程序。

## 功能特点

### ✅ 核心特性
1. **无边框设计** - 生成的图片不包含卡片边框，内容更简洁
2. **保持原样式** - 完整保留卡片的文字样式、颜色、对齐方式等
3. **支持折叠内容** - 对于被折叠的长文本，图片会自动调整高度显示完整内容
4. **多样式支持** - 支持各种背景色、透明背景、圆形卡片等样式
5. **双面内容** - 支持复制当前显示面的内容（正面或背面）

### 🎨 样式处理
- **背景色** - 准确还原卡片的背景颜色
- **文字颜色** - 根据背景自动调整文字颜色确保可读性
- **对齐方式** - 保持水平和垂直对齐设置
- **透明背景** - 透明卡片在图片中显示为白色背景
- **圆形卡片** - 保持圆形外观

### 📱 技术实现
- **html2canvas** - 使用html2canvas库将DOM元素转换为Canvas
- **高分辨率** - 生成2倍分辨率的高清图片
- **剪贴板API** - 使用现代浏览器的Clipboard API实现复制功能

## 使用方法

### 基本操作
1. 选中要复制的卡片
2. 点击卡片右上角的"..."菜单按钮
3. 在弹出的操作菜单中找到📷图标按钮
4. 点击"复制为图片"按钮
5. 在预览弹窗中查看图片效果
6. 点击"复制图片"按钮
7. 到其他应用（微信、QQ、Notion、邮件等）中粘贴

### 支持场景
- **普通文字卡片** - 直接复制文字内容
- **长文本卡片** - 自动展开显示完整内容
- **背面内容** - 翻转到背面后复制背面内容
- **网页卡片** - 复制当前显示的网页内容
- **各种样式** - 所有卡片样式都能正确转换

## 界面元素

### 按钮位置
复制为图片按钮位于卡片操作菜单中，具体位置：
- 颜色选择按钮右侧
- 图钉按钮右侧
- 翻转按钮左侧

### 按钮样式
- **图标** - 📷 相机符号
- **颜色** - 绿色背景 (#10b981)
- **交互** - 悬停时放大和加深颜色
- **提示** - 悬停显示"复制为图片"

### 预览弹窗
- **实时预览** - 显示生成的卡片图片效果
- **原尺寸显示** - 显示实际的卡片内容
- **复制按钮** - 一键复制图片到剪贴板
- **关闭功能** - 点击外部区域或×按钮关闭

## 兼容性

### 浏览器支持
- ✅ **Chrome** - 完全支持
- ✅ **Safari** - 完全支持
- ✅ **Firefox** - 完全支持
- ✅ **Edge** - 完全支持

### 系统支持
- ✅ **macOS** - 支持复制到系统剪贴板
- ✅ **Windows** - 支持复制到系统剪贴板
- ✅ **iOS/iPadOS** - 支持复制（需要较新版本）
- ✅ **Android** - 支持复制（需要较新版本）

## 错误处理

### 常见问题
1. **生成失败** - 控制台输出错误信息，用户看到"生成图片中..."
2. **复制失败** - 显示"复制失败，请重试"提示
3. **浏览器不支持** - 在不支持Clipboard API的浏览器中会显示错误提示

### 降级方案
- 如果Clipboard API不可用，可以考虑添加右键另存为功能
- 对于老版本浏览器，显示友好的不支持提示

## 性能优化

### 生成优化
- **异步生成** - 使用requestAnimationFrame确保DOM渲染完成
- **内存管理** - 及时释放生成的Canvas资源
- **大小限制** - 对于超大卡片自动调整生成分辨率

### 用户体验
- **加载状态** - 显示"生成图片中..."加载提示
- **成功反馈** - 复制成功后显示"图片已复制到剪贴板！"
- **快速响应** - 优化生成速度，通常在1-2秒内完成

## 技术细节

### 依赖项
```json
{
  "html2canvas": "^1.4.1",
  "@types/html2canvas": "^1.0.0"
}
```

### 核心代码文件
- `CardImagePreview.tsx` - 图片预览和生成组件
- `NodeCard.tsx` - 卡片主组件，包含处理函数
- `NodeCardActions.tsx` - 操作按钮组件

### 主要函数
- `generateCardImage()` - 生成卡片图片
- `copyImageToClipboard()` - 复制图片到剪贴板
- `handleCopyAsImage()` - 处理复制为图片的用户操作

## 更新日志

### v1.0.0 (2024-01-XX)
- ✅ 初始实现复制为图片功能
- ✅ 支持基本文字卡片
- ✅ 支持各种卡片样式
- ✅ 支持折叠内容自动展开
- ✅ 添加预览弹窗
- ✅ 集成到操作菜单

## 用户反馈

如果在使用过程中遇到问题或有改进建议，请及时反馈：

1. **图片质量问题** - 如果生成的图片模糊或不清晰
2. **样式丢失** - 如果某些样式在图片中显示不正确
3. **复制失败** - 如果在特定浏览器或系统中无法复制
4. **性能问题** - 如果生成图片的速度过慢

---

*该功能旨在提升用户的分享体验，让白板内容能够轻松分享到各种平台和应用中。* 