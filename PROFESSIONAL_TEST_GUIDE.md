# 专业连线功能测试指南

## 🧪 核心功能验证

### 测试1：缩放无关性验证
1. **创建连线**：
   - 双击创建两个卡片
   - 拖拽锚点创建连线
   
2. **缩放测试**：
   - 滚轮放大到200%
   - 滚轮缩小到50%
   - **预期结果**：连线粗细始终为2px，箭头大小固定

### 测试2：精确连接点验证
1. **边缘连接**：
   - 创建水平排列的两个卡片
   - 从左卡片右侧锚点连接到右卡片
   - **预期结果**：连线精确连接到卡片边缘，不穿过卡片内部

2. **垂直连接**：
   - 创建垂直排列的两个卡片
   - 从上卡片底部锚点连接到下卡片
   - **预期结果**：连线从卡片底边中点连接到上边中点

### 测试3：固定卡片连线
1. **混合连线**：
   - 创建两个普通卡片
   - 将其中一个卡片固定（图钉按钮）
   - 在固定卡片和普通卡片间创建连线
   - **预期结果**：连线正确连接，缩放时保持准确

### 测试4：智能路径生成
1. **多方向连线**：
   - 创建4个卡片，排列成十字形
   - 从中心卡片向四个方向创建连线
   - **预期结果**：每条连线都使用最优路径，曲线平滑自然

## 🎯 专业细节检查

### 视觉质量检查
- [ ] **连线粗细一致**：所有缩放级别下连线粗细为2px
- [ ] **箭头清晰**：箭头大小固定8px，形状规整
- [ ] **颜色过渡**：悬停时连线和箭头同步变为蓝色
- [ ] **虚线效果**：临时连线使用蓝色虚线，清晰可见

### 交互精度检查
- [ ] **锚点响应**：锚点悬停时放大20%，颜色变深
- [ ] **拖拽起点**：连线从锚点精确位置开始
- [ ] **实时预览**：拖拽过程中实时显示连线路径
- [ ] **目标检测**：松开鼠标时准确检测目标卡片

### 几何精度检查
- [ ] **边缘连接**：连线端点在卡片边缘，非内部
- [ ] **方向智能**：自动选择最短连接路径
- [ ] **控制点合理**：贝塞尔曲线控制点位置恰当
- [ ] **箭头对齐**：箭头与连线末端对齐

## 🔧 技术验证

### 坐标系统验证
```javascript
// 在浏览器控制台运行
const state = window.useBoardStore.getState();
console.log('Nodes:', state.nodes);
console.log('Connections:', state.connections);
console.log('Scale:', state.scale);
console.log('Pan:', state.panX, state.panY);
```

### 连线数据验证
```javascript
// 检查连线数据结构
state.connections.forEach((conn, i) => {
  console.log(`Connection ${i}:`, {
    from: conn.from,
    to: conn.to,
    fromNode: state.nodes.find(n => n.id === conn.from),
    toNode: state.nodes.find(n => n.id === conn.to)
  });
});
```

## 🚀 性能测试

### 大量连线测试
1. 创建10个卡片
2. 在每个卡片间创建连线（最多45条连线）
3. 测试缩放和拖拽的流畅性
4. **预期结果**：60fps流畅操作，无明显延迟

### 内存占用测试
```javascript
// 监控内存使用
console.log('Memory usage:', performance.memory);
```

## ✅ 通过标准

### 必须通过的测试
1. **缩放不变性**：所有缩放级别下连线保持2px粗细
2. **边缘精确性**：连线端点在卡片边缘，误差<1px
3. **交互流畅性**：拖拽操作延迟<16ms（60fps）
4. **视觉一致性**：颜色、样式与设计规范一致

### 专业级标准
1. **几何精度**：使用标准射线-矩形交点算法
2. **路径优化**：贝塞尔曲线平滑自然
3. **性能优化**：支持100+连线无性能问题
4. **用户体验**：操作直观，反馈及时

## 🎯 对比验证

### 与专业工具对比
可以与以下专业工具的连线效果进行对比：
- **Figma**：连线精度和视觉效果
- **Miro**：交互流畅性和智能路径
- **Draw.io**：几何算法和箭头设计

### 关键差异化优势
1. **固定卡片支持**：独特的固定卡片连线能力
2. **缩放无关性**：连线粗细不受缩放影响
3. **精确计算**：数学级的连接点精度
4. **智能路径**：自适应贝塞尔曲线生成

通过以上测试，可以验证连线系统是否达到了专业级标准。 